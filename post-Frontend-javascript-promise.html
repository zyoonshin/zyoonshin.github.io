<!DOCTYPE html>
<html lang="en"> 
<head>
    <title>Jiyoon's Blog - jQuery</title>
    
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Blog Template">
    <meta name="author" content="Xiaoying Riley at 3rd Wave Media">    
    <link rel="shortcut icon" href="favicon.ico"> 
    
    <!-- FontAwesome JS-->
	<script defer src="assets/fontawesome/js/all.min.js"></script>
    
    <!-- Plugin CSS -->
    <link rel="stylesheet" href="assets/plugins/highlight/styles/monokai-sublime.css">
    
    <!-- Theme CSS -->  
    <link id="theme-style" rel="stylesheet" href="assets/css/theme-3.css">
    

</head> 

<body>
    
    <header class="header text-center">	    
	    <h1 class="blog-name pt-lg-4 mb-0"><a class="no-text-decoration" href="blog-post.html">Jiyoon's Blog</a></h1>
        
	    <nav class="navbar navbar-expand-lg navbar-dark" >
           
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div id="navigation" class="collapse navbar-collapse flex-column" >
				<div class="profile-section pt-3 pt-lg-0">
				    <img class="profile-image mb-3 rounded-circle mx-auto" src="assets/images/profile.png" alt="image" >			
					
					<div class="bio mb-3">Hi, my name is Jiyoon Shin. Briefly introduce yourself here. You can also provide a link to the about page.<br><a href="about.html">Find out more about me</a></div><!--//bio-->
					<ul class="social-list list-inline py-3 mx-auto">
			            <li class="list-inline-item"><a href="#"><i class="fab fa-twitter fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="#"><i class="fab fa-linkedin-in fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="#"><i class="fab fa-github-alt fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="#"><i class="fab fa-stack-overflow fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="#"><i class="fab fa-codepen fa-fw"></i></a></li>
			        </ul><!--//social-list-->
			        <hr> 
				</div><!--//profile-section-->
				
				<ul class="navbar-nav flex-column text-start">
					<li class="nav-item">
						<a class="nav-link" href="index.html"><i class="fas fa-home fa-fw me-2"></i>Blog Home <span class="sr-only">(current)</span></a>
					</li>
					<li class="nav-item">
							<a class="nav-link active" href="index-concept.html"><i class="fas fa-bookmark fa-fw me-2"></i>Concepts</a>
					</li>
					<li class="nav-item">
							<a class="nav-link active" href="index-cs.html"><i class="fas fa-bookmark fa-fw me-2"></i>CS</a>
					</li>
					<li class="nav-item">
							<a class="nav-link active" href="index-frontend.html"><i class="fas fa-bookmark fa-fw me-2"></i>Frontend</a>
					</li>
					<li class="nav-item">
						<a class="nav-link active" href="index-backend.html"><i class="fas fa-bookmark fa-fw me-2"></i>Backend</a>
					</li>
					<li class="nav-item">
						<a class="nav-link active" href="index-project.html"><i class="fas fa-bookmark fa-fw me-2"></i>Project</a>
					</li>
					<li class="nav-item">
							<a class="nav-link" href="about.html"><i class="fas fa-user fa-fw me-2"></i>About Me</a>
					</li>
				</ul>
				
				<div class="my-2 my-md-3">
					
				    <a class="btn btn-primary" href="https://themes.3rdwavemedia.com/" target="_blank">Get in Touch</a>
				    
				</div>
			</div>
		</nav>
    </header>
    
    <div class="main-wrapper">
	    
	    <article class="blog-post px-3 py-5 p-md-5">
		    <div class="container single-col-max-width">
			    <header class="blog-post-header">
				    <h2 class="title mb-2">Promise</h2>
				    <div class="meta mb-3"><span class="date">Published 2 days ago</span><span class="time">5 min read</span>
						<span class="comment"><a  class="text-link" href="#">4 comments</a></span></div>
			    </header>

					<br>
				    <h3>Promise</h3>
						<ul>
							<li>Promise 객체는 비동기 작업이 맞이할 미래의 완료 또는 실패와 그 결과 값을 나타냄</li>
						</ul>

						<br>

						<h5>설명</h5>
						<ul>
							<li>Promise는 프로미스가 생성된 시점에는 알려지지 않았을 수도 있는 값을 위한 대리자</li>
							<li>비동기 연산이 종료된 이후에 결과 값과 실패 사유를 처리하기 위한 처리기를 연결 가능</li>
							<li>프로미스를 사용하면 비동기 메서드에서 마치 동기 메서드처럼 값을 반환 가능</li>
							<li>최종 결과를 반환 X</li>
							<p>→ 미래의 어떤 시점에 결과를 제공하겠다는 '약속'(promise) 반환</p>
						</ul>

						<br>

						<h5>Promise가 가지는 상태</h5>
						<ul>
							<li>대기(pending) : 이행하지도, 거부하지도 않은 초기 상태</li>
							<li>이행(fulfilled) : 연산이 성공적으로 완료</li>
							<li>거부(rejected) : 연산이 실패</li>
						</ul>
						<p>이행이나 거부될 때, 프로미스의 then 메서드에 의해 대기열(큐)에 추가된 처리기들이 호출</p>

						<pre>
							<code>app.get('/hello', (req, res) => {
  res.set('Access-Control-Allow-Origin', '*');
  res.set('Content-Type', 'text/plain; charset=UTF-8');

  // 호출 응답 보내줌
  setTimeout(()=> {
    res.send("Hello!");
  }, 3000);
}); </code>
						</pre>

						<h3>생성자와 작업 함수(executor)</h3>
						<h5>Promise 객체</h5>
						<ul>
							<li>executor가 실행한 비동기 작업 결과를 통지 받음</li>
							<li>통지 결과에 따라 약속된 다음 작업을 실행</li>
							<ul>
								<li>정상적으로 이행(fulfill)했다고 통지 받으면, fulfill 상태일 때 호출하기로 약속한 함수 실행</li>
								<li>어떤 이유로 작업 수행을 거절(reject)했다는 통지를 받으면,  reject 상태일 때 호출하기로 약속한 함수 실행</li>
							</ul>
						</ul>

						<ul>
							<li>new Promise(executor)</li>
							<ul>
								<li>executor : 생성자가 실행시킬 함수</li>
								<li>executor의 호출이 완료되어야만 Promise 객체 리턴</li>
							</ul>
						</ul>

						<pre>
							<code>let executer = (resolve, reject) => {
  // 시간이 오래 걸리는 동기 작업 수행
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "http://localhost:3000/hello", false); 
  xhr.send();
  console.log(xhr.responseText);
}

const promise = new Promise(executer);
// Promise 생성자의 executor 호출이 끝날 때까지 리턴하지 않는다.

console.log("끝!");
-> (3초 뒤)
   Hello!
   끝!</code>
						</pre>

					<h5>결론!</h5>
					<ul>
						<li>Promise 생성자에 전달한 executor의 호출이 끝날 때까지 Promise 객체 리턴X</li>
						<ul>
							<li>executor 에서 작업 시간이 올래 걸리는 동기 작업을 수행하는 것은 바람직X</li>
							<li>executor에 비동기 작업이 없다면 Promise를 사용하는 이점 X</li>
						</ul>
					</ul>

						<pre>
							<code>// executor의 정의를 파라미터에서 수행
const promise = new Promise((resolve, reject) => {
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "http://localhost:3000/hello", false); 
  xhr.send();
  console.log(xhr.responseText);
});

console.log("끝!");
-> (3초 뒤)
   Hello!
   끝!</code>
						</pre>

						<h3>작업 함수(executor)와 비동기 작업</h3>
						<ul>
							<li>Promise 생성자는 작업 함수(executor) 호출이 끝나는 즉시 Promise 객체 리턴</li>
							<ul>
								<li>작업 함수에서 실행하는 비동기 작업이 끝날 때까지 기다리지 X</li>
							</ul>
						</ul>

						<pre>
							<code>const promise = new Promise((resolve, reject) => {
  // 시간이 오래 걸리는 비동기 작업 수행
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true);
  xhr.send();
});

console.log("끝!");
-> 끝!
   (3초 뒤)
   Hello!</code>
						</pre>


						<h3>비동기 작업의 완료를 통지하기</h3>
						<ul>
							<li>promise 객체가 작업자(executor)로부터 작업 완료를 통지를 받았을 때 호출할 함수가 등록되어 있지 않다면 아무런 일도 수행 X</li>
						</ul>
							<pre>
								<code>const promise = new Promise((resolve, reject) => {
  // AJAX 프로그래밍, AJAX 요청 AJAX : 비동기 자바스크립트 와 XML
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
      resolve(); // 약속된 작업을 처리했다고 통지
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true); 
  xhr.send();
});

console.log("끝!");
-> 끝!
   (3초 뒤)
   Hello!</code>
							</pre>
	

							<h3>비동기 작업을 완료한 후 다음 작업 실행하기</h3>
							<pre>
								<code>function onFulfilled() { // on으로 시작하는 이유: 이벤트에 대해서 호출할 함수를 등록
  console.log("fulfilled!")
}

const promise = new Promise((resolve, reject) => {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true); 
  xhr.send();
});

// 작업 완료를 통보 받았을 때 호출될 함수 등록
// => resolve()로 통지했을 때 호출
promise.then(onFulfilled);
console.log("끝!");
-> 끝!
   (3초 뒤)
   Hello!
   fulfilled!</code>
							</pre>

					
							<h3>비동기 작업을 실행하는 중에 오류가 발생했음을 통지하기</h3>
							<ul>
								<li>executor로부터 작업 거절 통지를 받았을 때</li>
								<p>→ 그것을 처리할 함수가 등록되어 있지 않다면 예외 발생</p>
							</ul>
								<pre>
									<code>const promise = new Promise((resolve, reject) => {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
      reject(); // 문제가 발생하여 약속된 작업을 거절함을 알림
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true); 
  xhr.send();
});

console.log("끝!");
-> 끝!
   (3초 뒤)
   Hello!
   undefined</code>
								</pre>


								<h3>작업 거절 통보를 받았을 때 수행할 함수를 등록하기</h3>
								<pre>
									<code>function onRejected() {
  console.log("rejected!")
}

const promise = new Promise((resolve, reject) => {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
      reject(); // 문제가 발생하여 약속된 작업을 거절한다고 알린다.
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true); 
  xhr.send();
});

promise.then(undefined, onRejected);
// promise에 등록된(resolve했을 때 호출될 함수, reject했을 때 호출될 함수)

console.log("끝!");
-> 끝!
   (3초 뒤)
   Hello!
   rejected!</code>
								</pre>

					
								<h3>then(onFulfilled, onRejected)</h3>
								<h5>promise.then(onFulfilled, onRejected)</h5>
								<ul>
									<li>약속한 작업이 이행됐을 때 호출될 함수와 약속한 작업이 거절됐을 때 호출될 함수를 한 번에 등록 가능</li>
									<ul>
										<li>promise에 등록된(resolve했을 때 호출될 함수, reject했을 때 호출될 함수</li>
									</ul>
								</ul>
									<pre>
										<code>function onFulfilled() {
  console.log("fulfilled!")
}

function onRejected() {
  console.log("rejected!")
}

const promise = new Promise((resolve, reject) => {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
      resolve(); // 약속된 작업을 처리했다고 통지한다.
      //reject(); // 문제가 발생하여 약속된 작업을 거절한다고 알린다.
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true); 
  xhr.send();
});

console.log("끝!");

promise.then(onFulfilled, onRejected);

-> case 1) resolve();
   끝!
   (3초 뒤)
   Hello!
   fulfilled!
-> case 2) reject();
   끝!
   (3초 뒤)
   Hello!
   rejected!</code>
									</pre>

									<h3>익명 함수 활용하기</h3>
									<pre>
										<code>const promise = new Promise((resolve, reject) => {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
      resolve();
      //reject();
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true); 
  xhr.send();
});

promise.then(function() {console.log("fulfilled!")}, function() {console.log("rejected!")});

console.log("끝!");

-> case 1) resolve();
   끝!
   (3초 뒤)
   Hello!
   fulfilled!
-> case 1) reject();
   끝!
   (3초 뒤)
   Hello!
   rejected!</code>
									</pre>


									<h3>arrow function 활용하기</h3>
										<pre>
											<code>const promise = new Promise((resolve, reject) => {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
      resolve();
      //reject();
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true); 
  xhr.send();
});

promise.then(() => console.log("fulfilled!"), () => console.log("rejected!"));

console.log("끝!");

-> case 1) resolve();
   끝!
   (3초 뒤)
   Hello!
   fulfilled!
-> case 1) reject();
   끝!
   (3초 뒤)
   Hello!
   rejected!</code>
										</pre>

										<h3>then()의 리턴 값</h3>
										<h5>then()</h5>
										<ul>
											<li>작업을 정상적으로 수행했다는 통보가 왔을 때 호출될 함수 등록</li>
											<ul>
												<li>새로운 Promise 객체 리턴</li>
												<li>then()에 등록된 함수의 실행이 정상적으로 끝나면 새로 리턴한 Promise 객체에 통보</li>
											</ul>
										</ul>
										<pre>
											<code>const promise1 = new Promise((resolve, reject) => {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
      resolve();
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true); 
  xhr.send();
});

console.log("1111");

var promise2 = promise1.then(() => console.log("fulfilled...1"));

console.log("2222");

// 다음과 같이 promise2.then()을 사용하여 작업 함수를 등록해두면,
// promise2의 작업(executor)이 끝나면 자동으로 호출될 것이다. 
// 즉, promise.then()으로 등록한 작업 함수의 실행이 끝난 후 다음 순서로 호출될 것이다.
promise2.then(() => console.log("fulfilled...2"));

console.log("끝!");
-> 1111
	 2222
	 끝!
	 (3초 뒤)
	 Hello!
	 fulfilled...1
	 fulfilled...2</code>
										</pre>


										<h3>작업 함수를 체인 방식으로 연결하기</h3>
										<pre>
											<code>const promise1 = new Promise((resolve, reject) => {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4) {
      console.log(xhr.responseText);
      resolve();
    }
  };
  xhr.open("GET", "http://localhost:3000/hello", true); 
  xhr.send();
});

console.log("1111");

// 이전 작업 다음에 실행할 작업 함수를 등록하기
var promise2 = promise1.then(() => console.log("fulfilled...1")); 
console.log("2222");

// 이전 작업 다음에 실행할 작업 함수를 등록하기
var promise3 = promise2.then(() => console.log("fulfilled...2")); 
console.log("3333");

// 이전 작업 다음에 실행할 작업 함수를 등록하기
var promise4 = promise3.then(() => console.log("fulfilled...3")); 
console.log("4444");

// 이전 작업 다음에 실행할 작업 함수를 등록하기
promise4.then(() => console.log("fulfilled...4")); 

console.log("끝!");
-> 1111
   2222
   3333
   4444
   끝!
   (3초 뒤)
   Hello!
   fulfilled...1
   fulfilled...2
   fulfilled...3
   fulfilled...4</code>
										</pre>


										<h3>Method Chaining</h3>
				
				<nav class="blog-nav nav nav-justified my-5">
				  <a class="nav-link-prev nav-item nav-link rounded-left" href="#">Previous<i class="arrow-prev fas fa-long-arrow-alt-left"></i></a>
				  <a class="nav-link-next nav-item nav-link rounded-right" href="#">Next<i class="arrow-next fas fa-long-arrow-alt-right"></i></a>
				</nav>
				
				<div class="blog-comments-section">
					<div id="disqus_thread"></div>
					<script>
					    /**
					     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT 
					     *  THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR 
					     *  PLATFORM OR CMS.
					     *  
					     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: 
					     *  https://disqus.com/admin/universalcode/#configuration-variables
					     */
					    /*
					    var disqus_config = function () {
					        // Replace PAGE_URL with your page's canonical URL variable
					        this.page.url = PAGE_URL;  
					        
					        // Replace PAGE_IDENTIFIER with your page's unique identifier variable
					        this.page.identifier = PAGE_IDENTIFIER; 
					    };
					    */
					    
					    (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
					        var d = document, s = d.createElement('script');
					        
					        // IMPORTANT TODO: Replace 3wmthemes with your forum shortname!
					        s.src = 'https://3wmthemes.disqus.com/embed.js';
					        
					        s.setAttribute('data-timestamp', +new Date());
					        (d.head || d.body).appendChild(s);
					    })();
					</script>
					<noscript>
					    Please enable JavaScript to view the 
					    <a href="https://disqus.com/?ref_noscript" rel="nofollow">
					        comments powered by Disqus.
					    </a>
					</noscript>
				</div><!--//blog-comments-section-->
				
		    </div><!--//container-->
	    </article>
	    
	    <section class="promo-section theme-bg-light py-5 text-center">
		    <div class="container">
			    <h2 class="title">Promo Section Heading</h2>
			    <p>You can use this section to promote your side projects etc. Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. </p>
                <figure class="promo-figure">
			        <a href="https://made4dev.com" target="_blank"><img class="img-fluid" src="assets/images/promo-banner.jpg" alt="image"></a>
			    </figure>
		    </div><!--//container-->
	    </section><!--//promo-section-->
	    
	    <footer class="footer text-center py-2 theme-bg-dark">
		   
	        <!--/* This template is free as long as you keep the footer attribution link. If you'd like to use the template without the attribution link, you can buy the commercial license via our website: themes.3rdwavemedia.com Thank you for your support. :) */-->
            <small class="copyright">Designed with <span class="sr-only">love</span><i class="fas fa-heart" style="color: #fb866a;"></i> by <a href="https://themes.3rdwavemedia.com" target="_blank">Xiaoying Riley</a> for developers</small>
		   
	    </footer>
    
    </div><!--//main-wrapper-->
    

        
       
    <!-- Javascript -->          
    <script src="assets/plugins/popper.min.js"></script> 
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script> 

    <!-- Page Specific JS -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>

    <!-- Custom JS -->
    <script src="assets/js/blog.js"></script> 
	</body>
</html> 